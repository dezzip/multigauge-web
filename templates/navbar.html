<nav class="navbar">
    <div class="navbar-container">
        <div class="left-nav">
            <ul>
                <li><a href="/"><img src="/static/images/logo.svg" width="28px" height="28px"></a></li>
                <li class="nav-links"><a href="/products">Products</a></li>

                {% if current_user.is_authenticated %}
                    <li class="nav-links"><div class="nav-separator"></div></li>
                    <li class="nav-links"><a href="/devices">Devices</a></li>
                {% endif %}

                {% if current_user.is_authenticated and current_user.is_admin() %}
                    <li class="nav-links"><div class="nav-separator"></div></li>
                    <li class="nav-links"><a href="/admin">Admin</a></li>
                {% endif%}
            </ul>
        </div>

        <div class="right-nav">
            <ul>
                {% if current_user.is_authenticated %}
                <li class="desktop-only">
                    <a href="/notifications" style="display:flex; align-items:center; opacity: 0.5;">
                        <img src="/static/images/no_notification.png" width="22px" height="22px">
                    </a>
                </li>
                {% endif %}

                <li class="desktop-only" style="position: relative;">
                    <button class="profile-btn" onclick="toggleDropdown()">
                        <img src="/static/images/default_pfp.jpg" width="28px" height="28px">
                    </button>

                    <div class="dropdown-content">
                        {% if current_user.is_authenticated %}
                            <a href="/devices">My Devices</a>
                            <a href="/settings">Settings</a>
                            <a href="/logout">Log out</a>
                        {% else %}
                            <a href="/login">Log in</a>
                            <a href="/register">Sign up</a>
                        {% endif %}
                    </div>
                </li>

                <li class="desktop-only">
                    <a href="/cart" class="cart-button">
                        <img src="/static/images/cart.png" width="22px" height="22px">
                    </a>
                </li>

                <!-- Hamburger (mobile only) -->
                <li>
                    <button class="hamburger-btn" onclick="openMobileNav()" aria-label="Menu">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#1a1a2e" stroke-width="2.5" stroke-linecap="round">
                            <line x1="4" y1="6" x2="20" y2="6"/>
                            <line x1="4" y1="12" x2="20" y2="12"/>
                            <line x1="4" y1="18" x2="20" y2="18"/>
                        </svg>
                    </button>
                </li>
            </ul>
        </div>
    </div>
</nav>

<!-- Mobile nav drawer -->
<div class="mobile-nav-overlay" id="mobileNavOverlay" onclick="closeMobileNav()"></div>
<div class="mobile-nav" id="mobileNav">
    <div class="mobile-nav-header">
        <span class="mobile-nav-brand">Dezzip</span>
        <button class="mobile-nav-close" onclick="closeMobileNav()" aria-label="Close">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#1a1a2e" stroke-width="2.5" stroke-linecap="round">
                <line x1="6" y1="6" x2="18" y2="18"/><line x1="18" y1="6" x2="6" y2="18"/>
            </svg>
        </button>
    </div>
    <div class="mobile-nav-links">
        <a href="/">Home</a>
        <a href="/products">Products</a>
        {% if current_user.is_authenticated %}
            <div class="mobile-nav-divider"></div>
            <a href="/devices">My Devices</a>
            {% if current_user.is_admin() %}
                <a href="/admin">Admin</a>
            {% endif %}
            <a href="/settings">Settings</a>
        {% endif %}
        <div class="mobile-nav-divider"></div>
        <a href="/cart">Cart</a>
        {% if current_user.is_authenticated %}
            <a href="/logout">Log out</a>
        {% else %}
            <a href="/login">Log in</a>
            <a href="/register">Sign up</a>
        {% endif %}
    </div>
</div>

<script>
    function toggleDropdown() {
        const dropdown = document.querySelector('.dropdown-content');
        dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
    }
    document.addEventListener('click', function(e) {
        if (!e.target.closest('.profile-btn') && !e.target.closest('.dropdown-content')) {
            const dd = document.querySelector('.dropdown-content');
            if (dd) dd.style.display = 'none';
        }
    });

    function openMobileNav() {
        document.getElementById('mobileNav').classList.add('open');
        document.getElementById('mobileNavOverlay').classList.add('open');
        document.body.style.overflow = 'hidden';
    }
    function closeMobileNav() {
        document.getElementById('mobileNav').classList.remove('open');
        document.getElementById('mobileNavOverlay').classList.remove('open');
        document.body.style.overflow = '';
    }
</script>
